# Homework 7  作业报告 by 76-朱雨田

本次作业要求实现半隐式欧拉方法、隐式欧拉方法与 Liu13 三种弹簧质点模型算法，并设计基于惩罚力的物理球体碰撞模拟。

因为本次作业的展示图多为 gif，因此报告中不附图，仅引用压缩包内附带的 gif。

## 数据研究

### 1. 不同算法运行效率（无球体）

下列数据均在 Release 编译选项下测得。

网格均为 grid20x20.usda。Stiffness 均为 18.00。保证不发生爆炸。

#### 欧拉半隐式方法

| 参数                            | 值          |
| ------------------------------- | ----------- |
| h                               | 0.001       |
| damping                         | 0.200       |
| **平均每步时长 / μs** | **27.6831** |

#### 欧拉隐式方法

| 参数                  | 值          |
| --------------------- | ----------- |
| h                     | 0.020       |
| damping               | 1.000       |
| 循环终止条件                | $||\mathbf{x}'-\mathbf{x}||^2 < 10^{-3}$ |
| **平均迭代次数** | **3.29087** |
| **平均每步时长 / μs** | **11863.7** |

#### Liu 13 方法

| 参数                  | 值          |
| --------------------- | ----------- |
| h                     | 0.020       |
| damping               | 1.000       |
| 循环终止条件                | $||\mathbf{x}'-\mathbf{x}||^2 < 10^{-3}$ |
| **平均迭代次数** | **6.19664** |
| **平均每步时长 / μs** | **498.456** |

### 2. 不同算法运行效率（有球体）

下列数据均在 Release 编译选项下测得。

网格均为 grid20x20.usda。Stiffness 均为 180.00. 球体位置为 $(0, 0, 0.5)$，半径为 $0.4$，伸缩系数为 $1.1$，$k^{\text{penalty}}=8000$。

保证不发生爆炸。

#### 欧拉半隐式方法

测量了整个时间轴，布料始终覆盖在球体上。

| 参数                            | 值          |
| ------------------------------- | ----------- |
| h                               | 0.001       |
| damping                         | 0.200       |
| **平均每步时长 / μs** | **29.6346** |

#### 欧拉隐式方法

只取了测量时间在 100s 以内的数据，因为 100s 后布料滑落球体，不再与球体交互。

| 参数                  | 值          |
| --------------------- | ----------- |
| h                     | 0.020       |
| damping               | 1.000       |
| 循环终止条件                | $||\mathbf{x}'-\mathbf{x}||^2 < 10^{-3}$ |
| **平均迭代次数** | **7.06966** |
| **平均每步时长 / μs** | **24222.8** |

#### Liu 13 方法

测量了整个时间轴，布料始终覆盖在球体上。

| 参数                  | 值          |
| --------------------- | ----------- |
| h                     | 0.020       |
| damping               | 1.000       |
| 循环终止条件                | $||\mathbf{x}'-\mathbf{x}||^2 < 10^{-3}$ |
| **平均迭代次数** | **38.9329** |
| **平均每步时长 / μs** | **2227.29** |

### 3. 不同终止条件下的迭代次数与每步时长比较

网格均为 grid20x20.usda。参数均为 h=0.020, stiffness=180.00，无球体。保证不发生爆炸。

#### 欧拉隐式方法

终止条件为 1 时仍然能模拟得到很好的效果。

| $\|\mathbf{x}'-\mathbf{x}\|^2$  | $1$ | $10^{-1}$ | $10^{-2}$ | $10^{-3}$ | $10^{-4}$ | $10^{-5}$ |
| ---- | ---- | ---- | ---- | ---- | ---- | ---- |
| 平均迭代次数 | 2 | 2.00719 | 2.98561 | 3.71703 | 5 | 7.29496 |
| 平均每步时长 / μs | 7244.6 | 7396.92 | 10210.5 | 13196.2 | 18122.2 | 25914.2 |

#### Liu 13 方法

终止条件为 1, 0.1 时布料边缘有明显的三角面翻折。

| $\|\mathbf{x}'-\mathbf{x}\|^2$  | $1$ | $10^{-1}$ | $10^{-2}$ | $10^{-3}$ | $10^{-4}$ | $10^{-5}$ |
| ---- | ---- | ---- | ---- | ---- | ---- | ---- |
| 平均迭代次数 | 2 | 2 | 2.18465 | 9.09113 | 54.6866 | 100.892 |
| 平均每步时长 / μs | 202.981 | 198.715 | 213.396 | 619.432 | 3015.32 | 5941.71 |

从以上数据也能看出 Liu 13 方法收敛速度快、残差下降慢的特点。